CREATE TABLE IF NOT EXISTS klines_1m (
    time TIMESTAMPTZ NOT NULL,
    symbol TEXT NOT NULL,
    open DOUBLE PRECISION,
    high DOUBLE PRECISION,
    low DOUBLE PRECISION,
    close DOUBLE PRECISION,
    volume_quote DOUBLE PRECISION,
    PRIMARY KEY (time, symbol)
);

SELECT create_hypertable('klines_1m', 'time', if_not_exists => TRUE);

CREATE TABLE IF NOT EXISTS trade_log (
    id BIGSERIAL PRIMARY KEY,
    symbol TEXT NOT NULL,
    entry_time TIMESTAMPTZ NOT NULL,
    exit_time TIMESTAMPTZ,
    entry_price DOUBLE PRECISION,
    exit_price DOUBLE PRECISION,
    reason TEXT,
    pnl_pct DOUBLE PRECISION,
    created_at TIMESTAMPTZ DEFAULT now()
);

CREATE INDEX IF NOT EXISTS idx_trade_symbol_time
ON trade_log (symbol, entry_time DESC);



Pokud chceš, příště ti:

přidám detailní trade_log do DB

přidám BE move

přidám batch insert

přidám advanced risk control

1️⃣ Udělat SQL, který spočítá kompletní metriky (winrate, expectancy, PF)?
2️⃣ Přidat do systému automatické denní reporty?
3️⃣ Vysvětlit, jak poznáš, že strategie má skutečný edge?

1️⃣ Robustnosti (monitoring, healthcheck, alerty)
2️⃣ Výkonnosti strategie (optimalizace edge)
3️⃣ Risk managementu (position sizing, portfolio control)
4️⃣ Analytiky (dashboard + metriky)


-vypis konkretni env:
docker exec -it pump_app printenv | sort
docker exec -it pump_app printenv | grep -E "OBI_|PARTIAL|TRAIL|TP_R"

Rychlé doporučení k ladění

Pokud uvidíš, že ti to moc často “nechce ride” kvůli sell wall:

sniž WALL_RATIO třeba na 5.0 (detekuje víc wallů → spíš bude exitovat)

nebo zvýš na 8.0 (bude ignorovat menší wally → víc riding)

Pokud buy wall “moc drží” a nechává tě dlouho ve trade:

sniž BUY_WALL_EXTRA_TOLERANCE z 0.03 na 0.015

3. Sleduj "Spread" a likviditu
Úzký spread (malý rozdíl mezi nejlepší nabídkou a poptávkou): Znamená vysokou likviditu. Cena se pohybuje plynule.

Široký spread: Znamená nízkou likviditu. Riziko, že cena prudce spadne (slippage), je vysoké. Pokud se spread začne rozšiřovat, je čas na prodej.
